(this["webpackJsonpreact-burger"]=this["webpackJsonpreact-burger"]||[]).push([[0],{103:function(e,t,n){},18:function(e,t,n){e.exports={header:"app-header_header__c8dt3",header_container:"app-header_header_container__rufEh",header_left_wrapper:"app-header_header_left_wrapper__2dGPo",header_item:"app-header_header_item__2F-FA",active:"app-header_active__WNEL9"}},184:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(43),s=n.n(a),i=(n(103),n(11)),o=n(23),u=n(26),d=u.c,l=function(){return Object(u.b)()},p=n(12),b=n(18),O=n.n(b),j=n(1),_=function(){var e=Object(i.f)().path,t=d((function(e){return e.user.user}));return Object(j.jsx)("header",{children:Object(j.jsx)("nav",{className:"".concat(O.a.header," pt-4 pb-4"),children:Object(j.jsxs)("div",{className:O.a.header_container,children:[Object(j.jsxs)("ul",{className:O.a.header_left_wrapper,children:[Object(j.jsxs)(o.c,{to:"/",exact:!0,className:"".concat(O.a.header_item," pl-5 pr-5 pt-4 pb-4 mr-2"),activeClassName:O.a.active,children:[Object(j.jsx)("div",{className:"mr-2",children:Object(j.jsx)(p.BurgerIcon,{type:"/"===e?"primary":"secondary"})}),Object(j.jsx)("span",{className:"text text_type_main-default",children:"\u041a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440"})]}),Object(j.jsxs)(o.c,{className:"".concat(O.a.header_item," pl-5 pr-5 pt-4 pb-4"),to:"/feed",exact:!0,activeClassName:O.a.active,children:[Object(j.jsx)("div",{className:"mr-2",children:Object(j.jsx)(p.ListIcon,{type:"/feed"===e?"primary":"secondary"})}),Object(j.jsx)("span",{className:"text text_type_main-default",children:"\u041b\u0435\u043d\u0442\u0430 \u0437\u0430\u043a\u0430\u0437\u0430"})]})]}),Object(j.jsx)(o.b,{to:"/",className:O.a.header_logo,children:Object(j.jsx)(p.Logo,{})}),!t&&Object(j.jsxs)(o.c,{to:"/login",className:"".concat(O.a.header_item," pl-5 pr-5 pt-4 pb-4"),activeClassName:O.a.active,children:[Object(j.jsx)("div",{className:"mr-2",children:Object(j.jsx)(p.ProfileIcon,{type:"/login"===e?"primary":"secondary"})}),Object(j.jsx)("span",{className:"text text_type_main-default",children:"\u0412\u043e\u0439\u0442\u0438"})]}),t&&Object(j.jsxs)(o.c,{to:"/profile",className:"".concat(O.a.header_item," pl-5 pr-5 pt-4 pb-4"),activeClassName:O.a.active,children:[Object(j.jsx)("div",{className:"mr-2",children:Object(j.jsx)(p.ProfileIcon,{type:"/profile"===e||"/profile/orders"===e?"primary":"secondary"})}),Object(j.jsx)("span",{className:"text text_type_main-default",children:"\u041b\u0438\u0447\u043d\u044b\u0439 \u043a\u0430\u0431\u0438\u043d\u0435\u0442"})]})]})})})},m=function(e){var t=e.children;return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(_,{}),t]})},f=n(190),x=n(95),g=n(24),h=u.c,E=n(191),y=n(30),v=n.n(y),S=function(e){var t=e.ingredient,n=e.count,r=e.onIngredientClick,c=Object(i.e)(),a=t.name,s=t.price,u=t.image,d=t._id,l=Object(E.a)({type:"constructor",item:t}),b=Object(g.a)(l,2)[1];return Object(j.jsxs)(o.b,{to:{pathname:"/ingredients/".concat(d),state:{background:c}},onClick:function(){return r(t)},className:"".concat(v.a.ingredient),ref:b,"data-test":"ingredient",children:[Object(j.jsxs)("div",{className:"pl-4 pb-1 pr-4",children:[n&&Object(j.jsx)("div",{className:v.a.ingredient_counter,children:Object(j.jsx)(p.Counter,{count:n,size:"default"})}),Object(j.jsx)("img",{className:"".concat(v.a.ingredient_img," mb-1"),src:u,alt:a}),Object(j.jsxs)("div",{className:"".concat(v.a.ingredient_price_wrapper," mb-1"),children:[Object(j.jsx)("span",{className:"text text_type_digits-default",children:s}),Object(j.jsx)(p.CurrencyIcon,{type:"primary"})]})]}),Object(j.jsx)("h3",{className:"".concat(v.a.ingredient_name," text text_type_main-default"),children:a})]})},T=n(71),N=n.n(T),R=function(e){var t=e.title,n=e.type,c=e.onIngredientClick,a=d((function(e){return{ingredients:e.ingredients.ingredients,constructorIngredients:e.ingredients.constructorIngredients,constructorBun:e.ingredients.constructorBun}})),s=a.ingredients,i=a.constructorIngredients,o=a.constructorBun,u=Object(r.useMemo)((function(){var e={};return i.map((function(t){e[t._id]||(e[t._id]=0),e[t._id]++})),o&&(e[o._id]=2),e}),[i,o]),l=null===s||void 0===s?void 0:s.map((function(e){if(e.type===n)return Object(j.jsx)(S,{ingredient:e,count:u[e._id],onIngredientClick:c},e._id)}));return Object(j.jsxs)("div",{"data-scroll-id":n,className:"".concat(N.a.type_wrapper," pt-10"),children:[Object(j.jsx)("h3",{className:"text text_type_main-medium mb-6",children:t}),Object(j.jsx)("div",{className:N.a.ingredients_type_wrapper,children:l})]})},w=n(92),k=n.n(w),I=function(){return Object(j.jsx)("div",{className:k.a.loader,children:Object(j.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",style:{background:"none",display:"block",shapeRendering:"auto"},width:"60px",height:"60px",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",children:[Object(j.jsxs)("circle",{cx:"84",cy:"50",r:"10",fill:"#0051a2",children:[Object(j.jsx)("animate",{attributeName:"r",repeatCount:"indefinite",dur:"0.25s",calcMode:"spline",keyTimes:"0;1",values:"10;0",keySplines:"0 0.5 0.5 1",begin:"0s"}),Object(j.jsx)("animate",{attributeName:"fill",repeatCount:"indefinite",dur:"1s",calcMode:"discrete",keyTimes:"0;0.25;0.5;0.75;1",values:"#0051a2;#89bff8;#408ee0;#1b75be;#0051a2",begin:"0s"})]}),Object(j.jsxs)("circle",{cx:"16",cy:"50",r:"10",fill:"#0051a2",children:[Object(j.jsx)("animate",{attributeName:"r",repeatCount:"indefinite",dur:"1s",calcMode:"spline",keyTimes:"0;0.25;0.5;0.75;1",values:"0;0;10;10;10",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",begin:"0s"}),Object(j.jsx)("animate",{attributeName:"cx",repeatCount:"indefinite",dur:"1s",calcMode:"spline",keyTimes:"0;0.25;0.5;0.75;1",values:"16;16;16;50;84",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",begin:"0s"})]}),Object(j.jsxs)("circle",{cx:"50",cy:"50",r:"10",fill:"#1b75be",children:[Object(j.jsx)("animate",{attributeName:"r",repeatCount:"indefinite",dur:"1s",calcMode:"spline",keyTimes:"0;0.25;0.5;0.75;1",values:"0;0;10;10;10",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",begin:"-0.25s"}),Object(j.jsx)("animate",{attributeName:"cx",repeatCount:"indefinite",dur:"1s",calcMode:"spline",keyTimes:"0;0.25;0.5;0.75;1",values:"16;16;16;50;84",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",begin:"-0.25s"})]}),Object(j.jsxs)("circle",{cx:"84",cy:"50",r:"10",fill:"#408ee0",children:[Object(j.jsx)("animate",{attributeName:"r",repeatCount:"indefinite",dur:"1s",calcMode:"spline",keyTimes:"0;0.25;0.5;0.75;1",values:"0;0;10;10;10",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",begin:"-0.5s"}),Object(j.jsx)("animate",{attributeName:"cx",repeatCount:"indefinite",dur:"1s",calcMode:"spline",keyTimes:"0;0.25;0.5;0.75;1",values:"16;16;16;50;84",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",begin:"-0.5s"})]}),Object(j.jsxs)("circle",{cx:"16",cy:"50",r:"10",fill:"#89bff8",children:[Object(j.jsx)("animate",{attributeName:"r",repeatCount:"indefinite",dur:"1s",calcMode:"spline",keyTimes:"0;0.25;0.5;0.75;1",values:"0;0;10;10;10",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",begin:"-0.75s"}),Object(j.jsx)("animate",{attributeName:"cx",repeatCount:"indefinite",dur:"1s",calcMode:"spline",keyTimes:"0;0.25;0.5;0.75;1",values:"16;16;16;50;84",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",begin:"-0.75s"})]})]})})},C=n(31),D=n.n(C),U=function(e){var t=e.handleIngredientClick,n=Object(r.useState)("bun"),c=Object(g.a)(n,2),a=c[0],s=c[1],i=Object(r.useRef)(null),o=h((function(e){return{ingredients:e.ingredients.ingredients}})).ingredients,u=function(e){var t=document.querySelector('[data-scroll-id="'.concat(e,'"]'));if(t&&t instanceof HTMLElement){var n,r=t.offsetTop;null===(n=i.current)||void 0===n||n.scroll({left:0,top:r-247,behavior:"smooth"})}};return Object(j.jsxs)("section",{className:"".concat(D.a.section_container," pt-10"),children:[Object(j.jsx)("h1",{className:"".concat(D.a.title," text text_type_main-large mb-5"),children:"\u0421\u043e\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u0443\u0440\u0433\u0435\u0440"}),Object(j.jsxs)("div",{className:D.a.ingredients_wrapper,children:[!o&&Object(j.jsx)(I,{}),o&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"".concat(D.a.tab_wrapper),children:[Object(j.jsx)(p.Tab,{active:"bun"===a,onClick:function(){return u("bun")},value:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438",children:"\u0411\u0443\u043b\u043a\u0438"}),Object(j.jsx)(p.Tab,{active:"sauce"===a,onClick:function(){return u("sauce")},value:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438",children:"\u0421\u043e\u0443\u0441\u044b"}),Object(j.jsx)(p.Tab,{active:"main"===a,onClick:function(){return u("main")},value:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438",children:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438"})]}),Object(j.jsx)("div",{onScroll:function(e){var t=document.querySelector('[data-scroll-id="bun"]'),n=document.querySelector('[data-scroll-id="sauce"]'),r=document.querySelector('[data-scroll-id="main"]');e.target.scrollTop+248>t.offsetTop&&e.target.scrollTop+248<n.offsetTop&&"bun"!==a?s("bun"):e.target.scrollTop+248>n.offsetTop&&e.target.scrollTop+248<r.offsetTop&&"sauce"!==a?s("sauce"):e.target.scrollTop+248>r.offsetTop&&"main"!==a&&s("main")},ref:i,className:"".concat(D.a.ingredients_items_wrapper," pl-4 pb-10"),children:[{title:"\u0411\u0443\u043b\u043a\u0438",type:"bun"},{title:"\u0421\u043e\u0443\u0441\u044b",type:"sauce"},{title:"\u041d\u0430\u0447\u0438\u043d\u043a\u0438",type:"main"}].map((function(e){return Object(j.jsx)(R,{onIngredientClick:t,title:e.title,type:e.type},e.type)}))})]})]})]})},A=n(3),L=n(192),F=n(193),M="GET_INGREDIENTS_REQUEST",P="GET_INGREDIENTS_SUCCESS",G="GET_INGREDIENTS_FAILED",B="ADD_INGREDIENT_TO_CONSTRUCTOR",q="DELETE_INGREDIENT_FROM_CONSTRUCTOR",W="ADD_BUN_TO_CONSTRUCTOR",J="MOVE_INGREDIENT_IN_CONSTRUCTOR",Q="RESET_CONSTRUCTOR",z=n(49),H=n.n(z),X=function(e){var t=e.ingredient,n=e.index,c=l(),a=Object(r.useRef)(null),s=function(e){c(function(e){return{type:q,payload:e}}(e))},i=Object(L.a)({accept:"ingredient",collect:function(e){return{isHover:e.isOver()}},hover:function(e,t){var r;if(a.current){var s=e.index,i=n;if(s!==i){var o=null===(r=a.current)||void 0===r?void 0:r.getBoundingClientRect(),u=(o.bottom-o.top)/2,d=t.getClientOffset();if(d){var l=d.y-o.top;if(s<i&&l<u)return;if(s>i&&l>u)return;c({type:J,payload:{hoverIndex:i,dragIndex:s}}),e.index=i}}}}}),o=Object(g.a)(i,2)[1],u=Object(E.a)({type:"ingredient",item:function(){return{index:n}},collect:function(e){return{isDragging:e.isDragging()}}}),d=Object(g.a)(u,2),b=d[0].isDragging;return(0,d[1])(o(a)),Object(j.jsxs)("div",{ref:a,className:"".concat(H.a.constructor_item," ").concat(b?H.a.active:""," show_item"),"data-test":"constructor-ingredient",children:[Object(j.jsx)("div",{className:H.a.drag_icon,children:Object(j.jsx)(p.DragIcon,{type:"secondary"})}),Object(j.jsx)(p.ConstructorElement,{text:t.name,price:t.price,thumbnail:t.image,handleClose:function(){return s(t)}})]})},V=n(32),Y=n.n(V),$=function(e){var t=e.handleOrderClick,n=Object(i.d)(),c=Object(i.e)(),a=d((function(e){return{constructorIngredients:e.ingredients.constructorIngredients,constructorBun:e.ingredients.constructorBun,user:e.user.user}})),s=a.constructorIngredients,o=a.constructorBun,u=a.user,b=l(),O=Object(L.a)({accept:"constructor",drop:function(e){var t;"bun"!==e.type?b((t=Object(A.a)(Object(A.a)({},e),{},{drag_id:Object(F.a)()}),{type:B,payload:t})):b({type:W,payload:e})}}),_=Object(g.a)(O,2)[1],m=Object(r.useMemo)((function(){return o||s.length>0?s.reduce((function(e,t){return e+t.price}),0)+2*(o?o.price:0):0}),[s,o]);return Object(j.jsxs)("section",{className:"".concat(Y.a.section_container," pt-25"),children:[Object(j.jsxs)("div",{className:"pt-4 pr-4",ref:_,"data-test":"constructor",children:[!o&&0===s.length&&Object(j.jsx)("p",{className:"".concat(Y.a.no_ingredients," text text_type_main-default"),children:"\u041f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0441\u044e\u0434\u0430 \u0431\u0443\u043b\u043e\u0447\u043a\u0443 \u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u044b"}),o&&Object(j.jsx)("div",{className:"pl-8 mb-4 show_item",children:Object(j.jsx)(p.ConstructorElement,{type:"top",isLocked:!0,text:"".concat(o.name," (\u0432\u0435\u0440\u0445)"),price:o.price,thumbnail:o.image})}),s.length>0&&Object(j.jsx)("div",{className:"".concat(Y.a.wrapper_inner," mb-4"),children:s.map((function(e,t){return Object(j.jsx)(X,{index:t,ingredient:e},e.drag_id)}))}),o&&Object(j.jsx)("div",{className:"pl-8 pr-4 show_item",children:Object(j.jsx)(p.ConstructorElement,{type:"bottom",isLocked:!0,text:"".concat(o.name," (\u043d\u0438\u0437)"),price:o.price,thumbnail:o.image})})]}),Object(j.jsxs)("div",{className:"".concat(Y.a.constructor_footer),children:[Object(j.jsxs)("div",{className:"".concat(Y.a.total_wrapper," mr-10"),children:[Object(j.jsx)("span",{className:"text text_type_digits-medium",children:m}),Object(j.jsx)(p.CurrencyIcon,{type:"primary"})]}),Object(j.jsx)("div",{onClick:function(){u?o&&s.length>0&&t(c):n.push({pathname:"/login"})},children:Object(j.jsx)(p.Button,{type:"primary",size:"medium",children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})})]})]})},K=n(93),Z=n.n(K),ee=function(e){var t=e.handleIngredientClick,n=e.handleOrderClick;return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(f.a,{backend:x.a,children:Object(j.jsxs)("section",{className:Z.a.table_wrapper,children:[Object(j.jsx)(U,{handleIngredientClick:t}),Object(j.jsx)($,{handleOrderClick:n})]})})})},te="WS_ALL_ORDERS_CONNECTION_SUCCESS",ne="WS_ALL_ORDERS_CONNECTION_ERROR",re="WS_ALL_ORDERS_CONNECTION_CLOSED",ce="WS_ALL_ORDERS_GET_MESSAGE",ae="WS_ALL_ORDERS_CONNECTION_START",se="WS_USER_ORDERS_CONNECTION_SUCCESS",ie="WS_USER_ORDERS_CONNECTION_ERROR",oe="WS_USER_ORDERS_CONNECTION_CLOSED",ue="WS_USER_ORDERS_GET_MESSAGE",de="WS_USER_ORDERS_CONNECTION_START",le="GET_ORDER_REQUEST",pe="GET_ORDER_SUCCESS",be="GET_ORDER_FAILED",Oe="ORDER_RESET",je=function(){return{type:le}},_e=function(){return{type:be}},me="USER_REGISTER_REQUEST",fe="USER_LOGOUT_REQUEST",xe="USER_LOGIN_REQUEST",ge="UPDATE_USER_INFO_REQUEST",he="GET_USER_INFO_REQUEST",Ee="GET_USER_INFO_SUCCESS",ye="GET_USER_INFO_FAILED",ve="SET_EMAIL",Se="RESET_EMAIL",Te="SET_PASSWORD",Ne="RESET_PASSWORD",Re="SET_NAME",we="RESET_NAME",ke=function(){return{type:he}},Ie=function(e){return{type:Ee,payload:e}},Ce=function(){return{type:ye}},De=function(e){return{type:ve,payload:e}},Ue=function(){return{type:Se}},Ae=function(){return{type:Ne}},Le=function(e){return{type:Re,payload:e}},Fe="SET_MODAL_INNER_INGREDIENT_DETAILS",Me="SET_MODAL_INNER_ORDER_DETAILS",Pe="SET_CURRENT_INGREDIENT",Ge="SET_MODAL_INNER_ORDER_INFO",Be="SET_CURRENT_ORDER_INFO",qe=function(){var e=function(){var e=l(),t=Object(i.d)(),n=Object(i.e)(),c=("PUSH"===t.action&&n.state&&n.state.background,d((function(e){return{modalInner:e.modal.modalInner}})).modalInner,function(){e({type:Oe}),t.goBack()});return Object(r.useEffect)((function(){e({type:M}),localStorage.getItem("refreshToken")&&e(ke()),e({type:ae})}),[e]),Object(r.useEffect)((function(){var e=function(e){"Escape"===e.key&&c()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[]),Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(m,{children:Object(j.jsx)(ee,{handleIngredientClick:function(t){e({type:Pe,payload:t}),e({type:Fe})},handleOrderClick:function(n){e({type:Me}),t.push({pathname:"/order-details/4321",state:{background:n}}),e(je())}})})})};return Object(j.jsx)(o.a,{children:Object(j.jsx)(e,{})})},We=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,194)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))},Je=n(22),Qe=n(94),ze=n(96),He=n(40),Xe={ingredients:null,ingredientsRequest:!1,ingredientsFiled:!1,constructorIngredients:[],constructorBun:null};var Ve={ingredientsConstructor:null,currentIngredient:null,currentOrderInfo:null,modalInner:null};var Ye={order:null,orderRequest:!1,orderFiled:!1};var $e="SEND_EMAIL_REQUEST",Ke="SEND_EMAIL_SUCCESS",Ze="SEND_EMAIL_FAILED",et="RESET_PASSWORD_REQUEST",tt="RESET_PASSWORD_SUCCESS",nt="RESET_PASSWORD_FAILED",rt="SET_EMAILCODE",ct="RESET_EMAILCODE",at={sendEmailSuccess:null,sendEmailRequest:!1,sendEmailFailed:!1,resetPasswordRequest:!1,resetPasswordSuccess:null,resetPasswordFailed:!1,emailCode:""};var st={userReguest:!1,userFailed:!1,user:null,name:"",email:"",password:""};var it={wsAllOrdersConnect:!1,allOrders:null,wsUserOrdersConnect:!1,userOrders:null};var ot={wsInit:ae,onOpen:te,onClose:re,onError:ne,onMessage:ce},ut={wsInit:de,onOpen:se,onClose:oe,onError:ie,onMessage:ue},dt=Object(Je.b)({modal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Pe:return Object(A.a)(Object(A.a)({},e),{},{currentIngredient:t.payload});case Be:return Object(A.a)(Object(A.a)({},e),{},{currentOrderInfo:t.payload});case Fe:return Object(A.a)(Object(A.a)({},e),{},{modalInner:{title:"\u0414\u0435\u0442\u0430\u043b\u0438 \u0438\u043d\u0433\u0440\u0435\u0434\u0438\u0435\u043d\u0442\u0430",type:"ingredientDetails"}});case Me:return Object(A.a)(Object(A.a)({},e),{},{modalInner:{title:null,type:"orderDetails"}});case Ge:return Object(A.a)(Object(A.a)({},e),{},{modalInner:{title:t.payload,type:"orderInfo"}});default:return e}},order:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case le:return Object(A.a)(Object(A.a)({},e),{},{orderRequest:!0});case pe:return Object(A.a)(Object(A.a)({},e),{},{orderRequest:!1,order:t.payload});case be:return Object(A.a)(Object(A.a)({},e),{},{orderRequest:!1,orderFiled:!0});case Oe:return Object(A.a)(Object(A.a)({},e),{},{order:null});default:return e}},ingredients:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Xe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return Object(A.a)(Object(A.a)({},e),{},{ingredientsRequest:!0});case G:return Object(A.a)(Object(A.a)({},e),{},{ingredientsFiled:!0,ingredientsRequest:!1});case P:return Object(A.a)(Object(A.a)({},e),{},{ingredients:t.payload,ingredientsFiled:!1,ingredientsRequest:!1});case B:return Object(A.a)(Object(A.a)({},e),{},{constructorIngredients:[].concat(Object(He.a)(e.constructorIngredients),[t.payload])});case q:return Object(A.a)(Object(A.a)({},e),{},{constructorIngredients:e.constructorIngredients.filter((function(e){return e.drag_id!==t.payload.drag_id}))});case W:return Object(A.a)(Object(A.a)({},e),{},{constructorBun:t.payload});case J:var n=Object(He.a)(e.constructorIngredients),r=n[t.payload.dragIndex],c=n[t.payload.hoverIndex];return n[t.payload.hoverIndex]=r,n[t.payload.dragIndex]=c,Object(A.a)(Object(A.a)({},e),{},{constructorIngredients:n});case Q:return Object(A.a)(Object(A.a)({},e),{},{constructorIngredients:[],constructorBun:null});default:return e}},resetPassword:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:at,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $e:return Object(A.a)(Object(A.a)({},e),{},{sendEmailRequest:!0});case Ke:return Object(A.a)(Object(A.a)({},e),{},{sendEmailSuccess:t.payload,sendEmailRequest:!1,sendEmailFailed:!1});case Ze:return Object(A.a)(Object(A.a)({},e),{},{sendEmailFailed:!0,sendEmailRequest:!1});case et:return Object(A.a)(Object(A.a)({},e),{},{resetPasswordRequest:!0});case tt:return Object(A.a)(Object(A.a)({},e),{},{resetPasswordRequest:!1,resetPasswordFailed:!1,resetPasswordSuccess:t.payload});case nt:return Object(A.a)(Object(A.a)({},e),{},{resetPasswordRequest:!1,resetPasswordFailed:!0});case rt:return Object(A.a)(Object(A.a)({},e),{},{emailCode:t.payload});case ct:return Object(A.a)(Object(A.a)({},e),{},{emailCode:""});default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case he:return Object(A.a)(Object(A.a)({},e),{},{userReguest:!0});case Ee:return Object(A.a)(Object(A.a)({},e),{},{userReguest:!1,userFailed:!1,user:t.payload});case ye:return Object(A.a)(Object(A.a)({},e),{},{userReguest:!1,userFailed:!0,user:null});case ve:return Object(A.a)(Object(A.a)({},e),{},{email:t.payload});case Se:return Object(A.a)(Object(A.a)({},e),{},{email:""});case Te:return Object(A.a)(Object(A.a)({},e),{},{password:t.payload});case Ne:return Object(A.a)(Object(A.a)({},e),{},{password:""});case Re:return Object(A.a)(Object(A.a)({},e),{},{name:t.payload});case we:return Object(A.a)(Object(A.a)({},e),{},{name:""});default:return e}},wsOrders:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:it,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ae:case de:case te:return Object(A.a)(Object(A.a)({},e),{},{wsAllOrdersConnect:!0});case ne:case re:return Object(A.a)(Object(A.a)({},e),{},{wsAllOrdersConnect:!1});case ce:return Object(A.a)(Object(A.a)({},e),{},{allOrders:t.payload});case se:return Object(A.a)(Object(A.a)({},e),{},{wsUserOrdersConnect:!0});case ie:case oe:return Object(A.a)(Object(A.a)({},e),{},{wsUserOrdersConnect:!1});case ue:return Object(A.a)(Object(A.a)({},e),{},{userOrders:t.payload});default:return e}}}),lt=n(97);function pt(e,t,n){var r=(n=n||{}).expires;if("number"==typeof r&&r){var c=new Date;c.setTime(c.getTime()+1e3*r),r=n.expires=c}r&&r.toUTCString&&(n.expires=r.toUTCString());var a=e+"="+(t=encodeURIComponent(t));for(var s in n){a+="; "+s;var i=n[s];!0!==i&&(a+="="+i)}document.cookie="".concat(a,"; path=/;")}function bt(e){var t=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return t?decodeURIComponent(t[1]):void 0}var Ot=["success"],jt=function(e,t){return function(n){var r=null;return function(c){return function(a){var s=n.dispatch,i=a.type,o=t.wsInit,u=t.onOpen,d=t.onClose,l=t.onError,p=t.onMessage;i===o&&(r=e?new WebSocket("wss://norma.nomoreparties.space/orders?token=".concat(bt("accessToken"))):new WebSocket("wss://norma.nomoreparties.space/orders/all")),r&&(r.onopen=function(e){s({type:u,payload:e})},r.onerror=function(e){s({type:l,payload:e})},r.onmessage=function(e){var t=e.data,n=JSON.parse(t),r=(n.success,Object(lt.a)(n,Ot));s({type:p,payload:r})},r.onclose=function(e){s({type:d,payload:e})}),c(a)}}}},_t=n(9),mt=n.n(_t),ft=n(4),xt="https://norma.nomoreparties.space/api",gt=function(e){return e.ok?e.json().then((function(e){return(null===e||void 0===e?void 0:e.success)?e:Promise.reject(e)})):e.json().then((function(e){return Promise.reject(e)}))},ht=mt.a.mark(vt),Et=mt.a.mark(St),yt=function(){return fetch("".concat(xt,"/ingredients")).then(gt)};function vt(){var e;return mt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Object(ft.b)(yt);case 3:return e=t.sent,t.next=6,Object(ft.c)((n=e.data,{type:P,payload:n}));case 6:t.next=12;break;case 8:return t.prev=8,t.t0=t.catch(0),t.next=12,Object(ft.c)({type:G});case 12:case"end":return t.stop()}var n}),ht,null,[[0,8]])}function St(){return mt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ft.f)(M,vt);case 2:case"end":return e.stop()}}),Et)}var Tt=mt.a.mark(Mt),Nt=mt.a.mark(Pt),Rt=mt.a.mark(Gt),wt=mt.a.mark(Bt),kt=mt.a.mark(qt),It=mt.a.mark(Wt);function Ct(e,t){return fetch("".concat(xt,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({email:e,password:t})}).then(gt)}function Dt(){return fetch("".concat(xt,"/auth/logout"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({token:localStorage.getItem("refreshToken")})}).then(gt)}function Ut(){return fetch("".concat(xt,"/auth/user"),{method:"GET",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:"Bearer "+bt("accessToken")}}).then(gt)}function At(){return fetch("".concat(xt,"/auth/token"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({token:localStorage.getItem("refreshToken")})}).then((function(e){return e.json()})).catch((function(e){console.log(e)}))}function Lt(e,t,n){return fetch("".concat(xt,"/auth/user"),{method:"PATCH",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:"Bearer "+bt("accessToken")},body:JSON.stringify({email:e,name:t,password:n})}).then(gt)}function Ft(e,t,n){return fetch("".concat(xt,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({name:e,email:t,password:n})}).then(gt)}function Mt(){var e,t,n,r,c,a;return mt.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,Object(ft.d)((function(e){return{email:e.user.email,password:e.user.password}}));case 3:return e=s.sent,t=e.email,n=e.password,s.next=8,Object(ft.b)(Ct,t,n);case 8:return r=s.sent,s.next=11,Object(ft.c)(Ie(r.user));case 11:return s.next=13,Object(ft.c)(Ue());case 13:return s.next=15,Object(ft.c)(Ae());case 15:return s.next=17,Object(ft.c)(Le(r.user.name));case 17:return s.next=19,Object(ft.c)(De(r.user.email));case 19:c=r.accessToken.split("Bearer ")[1],a=r.refreshToken,pt("accessToken",c),localStorage.setItem("refreshToken",a),s.next=29;break;case 25:return s.prev=25,s.t0=s.catch(0),s.next=29,Object(ft.c)({type:"USER_LOGIN_FAILED"});case 29:case"end":return s.stop()}}),Tt,null,[[0,25]])}function Pt(){return mt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(ft.b)(Dt);case 3:return e.sent,localStorage.removeItem("refreshToken"),pt("accessToken",null,{expires:-1}),e.next=8,Object(ft.c)(Ie(null));case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(0),e.next=14,Object(ft.c)({type:"USER_LOGOUT_FAILED"});case 14:case"end":return e.stop()}}),Nt,null,[[0,10]])}function Gt(){var e,t,n,r;return mt.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,Object(ft.b)(Ut);case 3:return e=c.sent,c.next=6,Object(ft.c)(Ie(e.user));case 6:return c.next=8,Object(ft.c)(Le(e.user.name));case 8:return c.next=10,Object(ft.c)(De(e.user.email));case 10:c.next=32;break;case 12:if(c.prev=12,c.t0=c.catch(0),"jwt expired"!==(null===c.t0||void 0===c.t0?void 0:c.t0.message)){c.next=30;break}return c.next=17,Object(ft.b)(At);case 17:if(!(null===(t=c.sent)||void 0===t?void 0:t.success)){c.next=27;break}return n=t.accessToken.split("Bearer ")[1],r=t.refreshToken,pt("accessToken",n),localStorage.setItem("refreshToken",r),c.next=25,Object(ft.c)(ke());case 25:c.next=29;break;case 27:return c.next=29,Object(ft.c)(Ce());case 29:return c.abrupt("return");case 30:return c.next=32,Object(ft.c)(Ce());case 32:case"end":return c.stop()}}),Rt,null,[[0,12]])}function Bt(){var e,t,n,r,c,a,s,i;return mt.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,Object(ft.d)((function(e){return{email:e.user.email,name:e.user.name,password:e.user.password}}));case 3:return e=o.sent,t=e.email,n=e.name,r=e.password,o.next=9,Object(ft.b)(Lt,t,n,r);case 9:return c=o.sent,o.next=12,Object(ft.c)(Ie(c.user));case 12:return o.next=14,Object(ft.c)(Le(c.user.name));case 14:return o.next=16,Object(ft.c)(De(c.user.email));case 16:o.next=38;break;case 18:if(o.prev=18,o.t0=o.catch(0),"jwt expired"!==(null===o.t0||void 0===o.t0?void 0:o.t0.message)){o.next=36;break}return o.next=23,Object(ft.b)(At);case 23:if(!(null===(a=o.sent)||void 0===a?void 0:a.success)){o.next=33;break}return s=a.accessToken.split("Bearer ")[1],i=a.refreshToken,pt("accessToken",s),localStorage.setItem("refreshToken",i),o.next=31,Object(ft.c)({type:ge});case 31:o.next=35;break;case 33:return o.next=35,Object(ft.c)({type:"UPDATE_USER_INFO_FAILED"});case 35:return o.abrupt("return");case 36:return o.next=38,Object(ft.c)({type:"UPDATE_USER_INFO_FAILED"});case 38:case"end":return o.stop()}}),wt,null,[[0,18]])}function qt(){var e,t,n,r,c,a,s;return mt.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,Object(ft.d)((function(e){return{email:e.user.email,name:e.user.name,password:e.user.password}}));case 3:return e=i.sent,t=e.email,n=e.name,r=e.password,i.next=9,Object(ft.b)(Ft,t,n,r);case 9:return c=i.sent,i.next=12,Object(ft.c)(Ie(c.user));case 12:return i.next=14,Object(ft.c)(Ue());case 14:return i.next=16,Object(ft.c)(Ae());case 16:return i.next=18,Object(ft.c)({type:we});case 18:a=c.accessToken.split("Bearer ")[1],s=c.refreshToken,pt("accessToken",a),localStorage.setItem("refreshToken",s),i.next=28;break;case 24:return i.prev=24,i.t0=i.catch(0),i.next=28,Object(ft.c)({type:"USER_REGISTER_FAILED"});case 28:case"end":return i.stop()}}),kt,null,[[0,24]])}function Wt(){return mt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ft.f)(xe,Mt);case 2:return e.next=4,Object(ft.f)(fe,Pt);case 4:return e.next=6,Object(ft.f)(he,Gt);case 6:return e.next=8,Object(ft.f)(ge,Bt);case 8:return e.next=10,Object(ft.f)(me,qt);case 10:case"end":return e.stop()}}),It)}var Jt=mt.a.mark(Ht),Qt=mt.a.mark(Xt);function zt(e){return fetch("".concat(xt,"/orders"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:"Bearer "+bt("accessToken")},body:JSON.stringify({ingredients:e})}).then(gt)}function Ht(){var e,t,n,r,c,a,s,i,o;return mt.a.wrap((function(u){for(;;)switch(u.prev=u.next){case 0:return u.prev=0,u.next=3,Object(ft.d)((function(e){return{constructorIngredients:e.ingredients.constructorIngredients,constructorBun:e.ingredients.constructorBun}}));case 3:return e=u.sent,t=e.constructorIngredients,n=e.constructorBun,r=t.map((function(e){return e._id})),c=[].concat(Object(He.a)(r),[n._id,n._id]),u.next=10,Object(ft.b)(zt,c);case 10:return a=u.sent,u.next=13,Object(ft.c)((d=a.order,{type:pe,payload:d}));case 13:return u.next=15,Object(ft.c)({type:Q});case 15:u.next=37;break;case 17:if(u.prev=17,u.t0=u.catch(0),"jwt expired"!==(null===u.t0||void 0===u.t0?void 0:u.t0.message)){u.next=35;break}return u.next=22,Object(ft.b)(At);case 22:if(!(null===(s=u.sent)||void 0===s?void 0:s.success)){u.next=32;break}return i=s.accessToken.split("Bearer ")[1],o=s.refreshToken,pt("accessToken",i),localStorage.setItem("refreshToken",o),u.next=30,Object(ft.c)(je());case 30:u.next=34;break;case 32:return u.next=34,Object(ft.c)(_e());case 34:return u.abrupt("return");case 35:return u.next=37,Object(ft.c)(_e());case 37:case"end":return u.stop()}var d}),Jt,null,[[0,17]])}function Xt(){return mt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ft.f)(le,Ht);case 2:case"end":return e.stop()}}),Qt)}var Vt=function(e){return{type:Ke,payload:e}},Yt=function(e){return{type:tt,payload:e}},$t=mt.a.mark(nn),Kt=mt.a.mark(rn),Zt=mt.a.mark(cn),en=function(e){return fetch("".concat(xt,"/password-reset"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({email:e})}).then(gt)},tn=function(e,t){return fetch("".concat(xt,"/password-reset/reset"),{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({password:e,token:t})}).then(gt)};function nn(){var e,t;return mt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(ft.d)((function(e){return e.user.email}));case 3:return e=n.sent,n.next=6,Object(ft.b)(en,e);case 6:return t=n.sent,n.next=9,Object(ft.c)(Vt(t));case 9:return n.next=11,Object(ft.c)(Ue());case 11:n.next=17;break;case 13:return n.prev=13,n.t0=n.catch(0),n.next=17,Object(ft.c)({type:Ze});case 17:case"end":return n.stop()}}),$t,null,[[0,13]])}function rn(){var e,t,n,r;return mt.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,Object(ft.d)((function(e){return{password:e.user.password,emailCode:e.resetPassword.emailCode}}));case 3:return e=c.sent,t=e.emailCode,n=e.password,c.next=8,Object(ft.b)(tn,n,t);case 8:return r=c.sent,c.next=11,Object(ft.c)(Yt(r));case 11:return c.next=13,Object(ft.c)({type:ct});case 13:return c.next=15,Object(ft.c)(Ae());case 15:c.next=21;break;case 17:return c.prev=17,c.t0=c.catch(0),c.next=21,Object(ft.c)({type:nt});case 21:case"end":return c.stop()}}),Kt,null,[[0,17]])}function cn(){return mt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ft.f)(et,rn);case 2:return e.next=4,Object(ft.f)($e,nn);case 4:case"end":return e.stop()}}),Zt)}var an=mt.a.mark(sn);function sn(){var e;return mt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=[St,Wt,cn,Xt],t.next=3,Object(ft.a)(e.map((function(e){return Object(ft.e)(e)})));case 3:case"end":return t.stop()}}),an)}var on=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Je.c,un=Object(ze.a)(),dn=on(Object(Je.a)(Qe.a,un,jt(null,ot),jt("token",ut))),ln=Object(Je.d)(dt,dn);un.run(sn),s.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(u.a,{store:ln,children:Object(j.jsx)(qe,{})})}),document.getElementById("root")),We()},30:function(e,t,n){e.exports={ingredient:"burger-ingredients-item_ingredient__1LaZE",ingredient_counter:"burger-ingredients-item_ingredient_counter__14gGL",ingredient_img:"burger-ingredients-item_ingredient_img__1z1dM",ingredient_price_wrapper:"burger-ingredients-item_ingredient_price_wrapper__265cz",ingredient_name:"burger-ingredients-item_ingredient_name__29_CH"}},31:function(e,t,n){e.exports={section_container:"burger-ingredients_section_container__1oTn8",tab_wrapper:"burger-ingredients_tab_wrapper__2lQT1",ingredients_wrapper:"burger-ingredients_ingredients_wrapper__1kCF3",ingredients_items_wrapper:"burger-ingredients_ingredients_items_wrapper__1CLRc"}},32:function(e,t,n){e.exports={section_container:"burger-constructor_section_container__lcMgw",drop:"burger-constructor_drop__s8D0K",wrapper_inner:"burger-constructor_wrapper_inner__1vaQ6",constructor_footer:"burger-constructor_constructor_footer__3kmy-",total_wrapper:"burger-constructor_total_wrapper__cSjtN",no_ingredients:"burger-constructor_no_ingredients__2h0F5"}},49:function(e,t,n){e.exports={constructor_item:"burger-constructor-item_constructor_item__2bo2d",active:"burger-constructor-item_active__wqT_0"}},71:function(e,t,n){e.exports={ingredients_type_wrapper:"burger-ingredients-list_ingredients_type_wrapper__3wuJj"}},92:function(e,t,n){e.exports={loader:"loader_loader__29N7Y"}},93:function(e,t,n){e.exports={table_wrapper:"constructor-page_table_wrapper__1upOA"}}},[[184,1,2]]]);
//# sourceMappingURL=main.ce262cef.chunk.js.map